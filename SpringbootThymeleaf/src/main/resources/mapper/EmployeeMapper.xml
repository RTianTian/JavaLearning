<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="icu.xuyijie.springbootthymeleaf.mapper.EmployeeMapper">

    <select id="searchEmployeeList" resultType="icu.xuyijie.springbootthymeleaf.entity.Employee">
        SELECT
        id,
        username,
        duty,
        DATE_FORMAT(create_time, '%Y-%m-%d %H:%i:%s') AS createTime,
        DATE_FORMAT(edit_time, '%Y-%m-%d %H:%i:%s') editTime,
        is_depart,
        is_delete
        FROM employee
        WHERE is_delete = false
        <if test="username != null and username != ''">
            AND username LIKE CONCAT('%', #{username}, '%')
        </if>
        <if test="duty != null and duty != ''">
            AND username LIKE '%' + #{duty} + '%'
        </if>
        ORDER BY create_time DESC
    </select>

    <insert id="insert">
        INSERT INTO employee
        VALUES (#{id}, #{username}, #{duty}, CURRENT_TIME, #{editTime}, #{isDepart}, #{isDelete})
    </insert>

    <update id="update">
        UPDATE employee
        SET username  = #{username},
            duty      = #{duty},
            edit_time = CURRENT_TIME,
            is_depart = #{isDepart},
            is_delete = #{isDelete}
        WHERE id = #{id}
    </update>

    <update id="departOrEntryEmployee">
        UPDATE employee
        SET edit_time = CURRENT_TIME,
            is_depart = #{isDepart}
        WHERE id = #{id}
    </update>

    <update id="delete">
        UPDATE employee
        SET edit_time = CURRENT_TIME,
            is_delete = true
        WHERE id = #{id}
    </update>

</mapper>
